{"ast":null,"code":"import { request } from \"../../api/request\";\nimport { makeRandomId } from '../helpers';\nexport const ENVIRONMENT = 'ENVIRONMENT';\nexport const CAN_PLAY_AUCTIONS = 'CAN_PLAY_AUCTIONS';\nexport function setCanPlayAuction() {\n  let currentTimeStamp = parseInt(new Date() / 1000);\n  request('/getTime').then(data => {\n    let serverTimeStamp = parseInt(data);\n    let diff = Math.abs(serverTimeStamp - currentTimeStamp);\n  });\n}\nexport default (store => next => action => {\n  let params = action[ENVIRONMENT];\n\n  if (typeof params === 'undefined') {\n    return next(action);\n  }\n\n  let {\n    action_type\n  } = params;\n  let tabId = makeRandomId(1000);\n  onTabVisibilityChange(() => {\n    let hidden = onTabVisibilityChange();\n\n    if (!hidden) {\n      store.dispatch(setCookieTabId(tabId));\n    }\n  });\n  store.dispatch(setCookieTabId(tabId));\n  next({\n    type: action_type\n  });\n});","map":{"version":3,"sources":["/home/aziza/reactapp/src/middlewares/environment.js"],"names":["request","makeRandomId","ENVIRONMENT","CAN_PLAY_AUCTIONS","setCanPlayAuction","currentTimeStamp","parseInt","Date","then","data","serverTimeStamp","diff","Math","abs","store","next","action","params","action_type","tabId","onTabVisibilityChange","hidden","dispatch","setCookieTabId","type"],"mappings":"AAAA,SAAQA,OAAR,QAAsB,mBAAtB;AACA,SAAQC,YAAR,QAA2B,YAA3B;AAEA,OAAO,MAAMC,WAAW,GAAG,aAApB;AAEP,OAAO,MAAMC,iBAAiB,GAAG,mBAA1B;AACP,OAAO,SAASC,iBAAT,GAA6B;AACnC,MAAIC,gBAAgB,GAAGC,QAAQ,CAAC,IAAIC,IAAJ,KAAW,IAAZ,CAA/B;AACAP,EAAAA,OAAO,CAAC,UAAD,CAAP,CAAoBQ,IAApB,CAAyBC,IAAI,IAAI;AAChC,QAAIC,eAAe,GAAGJ,QAAQ,CAACG,IAAD,CAA9B;AACA,QAAIE,IAAI,GAAGC,IAAI,CAACC,GAAL,CAASH,eAAe,GAACL,gBAAzB,CAAX;AACA,GAHD;AAIA;AACD,gBAAeS,KAAK,IAAIC,IAAI,IAAIC,MAAM,IAAI;AACzC,MAAIC,MAAM,GAAGD,MAAM,CAACd,WAAD,CAAnB;;AACA,MAAI,OAAOe,MAAP,KAAkB,WAAtB,EAAmC;AAClC,WAAOF,IAAI,CAAEC,MAAF,CAAX;AACA;;AACD,MAAI;AACHE,IAAAA;AADG,MAEAD,MAFJ;AAGA,MAAIE,KAAK,GAAGlB,YAAY,CAAC,IAAD,CAAxB;AAEAmB,EAAAA,qBAAqB,CAAC,MAAM;AAC3B,QAAIC,MAAM,GAAGD,qBAAqB,EAAlC;;AACA,QAAI,CAACC,MAAL,EAAa;AACZP,MAAAA,KAAK,CAACQ,QAAN,CAAeC,cAAc,CAACJ,KAAD,CAA7B;AACA;AACD,GALoB,CAArB;AAMAL,EAAAA,KAAK,CAACQ,QAAN,CAAeC,cAAc,CAACJ,KAAD,CAA7B;AACAJ,EAAAA,IAAI,CAAC;AACJS,IAAAA,IAAI,EAAEN;AADF,GAAD,CAAJ;AAGA,CApBD","sourcesContent":["import {request} from \"../../api/request\";\nimport {makeRandomId} from '../helpers'\n\nexport const ENVIRONMENT = 'ENVIRONMENT';\n\nexport const CAN_PLAY_AUCTIONS = 'CAN_PLAY_AUCTIONS';\nexport function setCanPlayAuction() {\n\tlet currentTimeStamp = parseInt(new Date()/1000);\n\trequest('/getTime').then(data => {\n\t\tlet serverTimeStamp = parseInt(data);\n\t\tlet diff = Math.abs(serverTimeStamp-currentTimeStamp);\n\t});\n}\nexport default store => next => action => {\n\tlet params = action[ENVIRONMENT];\n\tif (typeof params === 'undefined') {\n\t\treturn next( action );\n\t}\n\tlet {\n\t\taction_type,\n\t} = params;\n\tlet tabId = makeRandomId(1000);\n\n\tonTabVisibilityChange(() => {\n\t\tlet hidden = onTabVisibilityChange();\n\t\tif (!hidden) {\n\t\t\tstore.dispatch(setCookieTabId(tabId));\n\t\t}\n\t});\n\tstore.dispatch(setCookieTabId(tabId));\n\tnext({\n\t\ttype: action_type,\n\t});\n}\n"]},"metadata":{},"sourceType":"module"}