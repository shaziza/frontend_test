{"ast":null,"code":"import merge from 'lodash/merge';\nimport mergeWith from 'lodash/mergeWith';\nimport databaseReducer from './database';\nimport helperReducer from './helper';\nimport historyReducer from './history';\nimport { REQUEST_DATA, DATA_REMOVE, RESPONSE_DATA_ADD, RESPONSE_DATA_REPLACE, RESPONSE_DATA_NONE, RESPONSE_AUTH_USER, RESPONSE_FAIL, RESET_ON_PAGE, MODAL_OPEN_INFO, MODAL_OPEN_WITH_PARAMS, MODAL_OPEN, MODAL_CLOSE, CLEAR_ERRORS, CHANGE_RESULT, GEO_CHANGE, GEO_COORDS_CHANGE, SET_CURRENCY, SET_UPDATE_INFO, SET_LAST_ERROR, SET_GEO_LIST, SET_AUTH_USER, START_FETCH, STOP_FETCH } from '../actions/actionsTypes';\n\nconst entitiesReducer = (state = [], action) => {\n  switch (action.type) {\n    case RESPONSE_DATA_REPLACE:\n    case RESPONSE_DATA_ADD:\n    case RESPONSE_DATA_NONE:\n    case RESPONSE_AUTH_USER:\n      return merge({}, state, action.response.data.entities);\n\n    default:\n      return state;\n  }\n};\n/**\n * Creates array of fetched results - array with ids of entities\n * @param  {Object} [state={}] [description]\n * @param  {[type]} action     [description]\n * @return {[type]}            [description]\n */\n\n\nconst resultReducer = (state = {}, action) => {\n  let new_state = Object.assign({}, state);\n  let ids = [];\n\n  switch (action.type) {\n    case RESET_ON_PAGE:\n      console.trace(\"DEPRECATED\");\n      return Object.assign({}, state, {\n        [action.key]: []\n      });\n\n    case RESPONSE_DATA_ADD:\n      console.trace(\"DEPRECATED\");\n      return mergeWith(state, action.response.data.result, merger);\n\n    case DATA_REMOVE:\n      console.trace(\"DEPRECATED\");\n\n      for (let i in new_state[action.key][action.category_id]) {\n        if (action.ids.indexOf(new_state[action.key][action.category_id][i]) === -1) {\n          ids.push(new_state[action.key][action.category_id][i]);\n        }\n      }\n\n      new_state[action.key][action.category_id] = ids;\n      return new_state;\n\n    case RESPONSE_DATA_REPLACE:\n      return Object.assign({}, state, action.response.data.result);\n\n    case CHANGE_RESULT:\n      return Object.assign({}, state, {\n        [action.key]: action.ids\n      });\n\n    case RESPONSE_DATA_NONE:\n    default:\n      return state;\n  }\n};\n\nconst fetchedReducer = (state = {}, action) => {\n  switch (action.type) {\n    case REQUEST_DATA:\n    case START_FETCH:\n      return merge({}, state, {\n        [action.key]: true\n      });\n\n    case STOP_FETCH:\n    case RESPONSE_DATA_ADD:\n    case RESPONSE_DATA_REPLACE:\n    case RESPONSE_DATA_NONE:\n    case RESPONSE_FAIL:\n      return merge({}, state, {\n        [action.key]: false\n      });\n\n    default:\n      return state;\n  }\n};\n\nconst lastIdsReducer = (state = {}, action) => {\n  switch (action.type) {\n    case RESPONSE_DATA_ADD:\n    case RESPONSE_DATA_REPLACE:\n    case RESPONSE_DATA_NONE:\n      return Object.assign({}, state, {\n        [action.key]: action.response.last_id\n      });\n\n    default:\n      return state;\n  }\n};\n\nconst allReducer = (state = {}, action) => {\n  switch (action.type) {\n    case RESPONSE_DATA_REPLACE:\n      return Object.assign({}, state, {\n        [action.key]: action.response.all_count || null\n      });\n\n    case RESET_ON_PAGE:\n      return Object.assign({}, state, {\n        [action.key]: null\n      });\n\n    default:\n      return state;\n  }\n}; // const onPageReducer = (state = {}, action) => {\n//   let data, per_page;\n//   switch (action.type) {\n//     case RESET_ON_PAGE:\n//       return merge({}, state, {\n//         [action.key]: action.per_page || 20\n//       });\n//     case RESPONSE_DATA_REPLACE:\n//       data = action.response.data.result[action.key];\n//       return merge({}, state, {\n//         [action.key]: data.length\n//       });\n//     case RESPONSE_DATA_ADD:\n//       data = action.response.data.result[action.key];\n//       per_page = state[action.key] + data.length;\n//       return merge({}, state, {\n//         [action.key]: per_page\n//       });\n//     case RESPONSE_DATA_NONE:\n//     default:\n//       return state;\n//   }\n// }\n\n\nconst authReducer = (state = null, action) => {\n  switch (action.type) {\n    case SET_AUTH_USER:\n      return action.id;\n\n    case RESPONSE_AUTH_USER:\n      return action.response.data.result.users[0];\n\n    case RESPONSE_FAIL:\n      if (action.key === USERS_KEY && [102, 103].includes(action.error_status)) return 0;\n      return state;\n\n    default:\n      return state;\n  }\n};\n\nconst modalsReducer = (state = {\n  [INFO_MODAL_KEY]: {},\n  [IMAGE_MODAL_KEY]: {},\n  [ATTACH_MODAL_KEY]: {}\n}, action) => {\n  switch (action.type) {\n    case MODAL_OPEN_WITH_PARAMS:\n      return merge({}, state, {\n        [action.modal_key]: Object.assign({\n          active: true\n        }, action.params)\n      });\n\n    case MODAL_OPEN_INFO:\n      return merge({}, state, {\n        [action.modal_key]: {\n          type: action.modal_type,\n          active: true,\n          options: action.options\n        }\n      });\n\n    case MODAL_OPEN:\n      return merge({}, state, {\n        [action.modal_key]: true\n      });\n\n    case MODAL_CLOSE:\n      return merge({}, state, {\n        [action.modal_key]: false\n      });\n\n    default:\n      return state;\n  }\n};\n\nconst errorsReducer = (state = {}, action) => {\n  switch (action.type) {\n    case RESPONSE_FAIL:\n      if (action.main) {\n        return {\n          status: action.error_status,\n          text: action.error\n        };\n      } else {\n        return state;\n      }\n\n    case RESPONSE_DATA_ADD:\n    case RESPONSE_DATA_REPLACE:\n    case RESPONSE_DATA_NONE:\n    case RESPONSE_AUTH_USER:\n    case CLEAR_ERRORS:\n      return {};\n\n    default:\n      return state;\n  }\n};\n\nconst regReducer = (state = {\n  status: REG_INIT_KEY\n}) => {\n  return state;\n};\n\nconst inititialGeo = {\n  lists: {\n    city: [],\n    region: [],\n    country: []\n  }\n};\nconst geoListTypes = {\n  '-1': 'country',\n  1: 'country',\n  2: 'region',\n  3: 'city'\n};\n\nconst geoReducer = (state = inititialGeo, action) => {\n  let new_state = Object.assign({}, state);\n\n  switch (action.type) {\n    case SET_GEO_LIST:\n      for (let i in geoListTypes) {\n        new_state.lists[geoListTypes[i]] = [];\n      }\n\n      for (let i in action.items) {\n        new_state.lists[geoListTypes[action.items[i].type]].push(action.items[i]);\n      }\n\n      return new_state;\n\n    case GEO_CHANGE:\n    case GEO_COORDS_CHANGE:\n      return Object.assign({}, state, action.data);\n\n    default:\n      return state;\n  }\n};\n\nconst currencyReducer = (state = {}, action) => {\n  switch (action.type) {\n    case SET_CURRENCY:\n      return {\n        id: action.id\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst environmentReducer = (state = {\n  user: {},\n  messages: {},\n  menu: {}\n}, action) => {\n  let new_state = Object.assign({}, state);\n\n  switch (action.type) {\n    case SET_UPDATE_INFO:\n      new_state.updates = Object.assign({}, new_state.updates, {\n        [action.platform]: action.version\n      });\n      return new_state;\n\n    case SET_LAST_ERROR:\n      new_state.lastError = action.text;\n      return new_state;\n\n    default:\n      return state;\n  }\n};\n\nexport default ((state = {}, action) => {\n  return {\n    ssrInfo: state.ssrInfo === undefined ? {\n      available: false\n    } : state.ssrInfo,\n    isClient: state.isClient === undefined ? true : state.isClient,\n    entities: entitiesReducer(state.entities, action),\n    result: resultReducer(state.result, action),\n    fetched: fetchedReducer(state.fetched, action),\n    lastIds: lastIdsReducer(state.lastIds, action),\n    all: allReducer(state.all, action),\n    authUser: authReducer(state.authUser, action),\n    modals: modalsReducer(state.modals, action),\n    errors: errorsReducer(state.errors, action),\n    reg: regReducer(state.reg, action),\n    geo: geoReducer(state.geo, action),\n    currency: currencyReducer(state.currency, action),\n    environment: environmentReducer(state.environment, action),\n    database: databaseReducer(state.database, action),\n    helper: helperReducer(state.helper, action),\n    history: historyReducer(state.history, action)\n  };\n});","map":{"version":3,"sources":["/home/aziza/reactapp/src/reducers/app.js"],"names":["merge","mergeWith","databaseReducer","helperReducer","historyReducer","REQUEST_DATA","DATA_REMOVE","RESPONSE_DATA_ADD","RESPONSE_DATA_REPLACE","RESPONSE_DATA_NONE","RESPONSE_AUTH_USER","RESPONSE_FAIL","RESET_ON_PAGE","MODAL_OPEN_INFO","MODAL_OPEN_WITH_PARAMS","MODAL_OPEN","MODAL_CLOSE","CLEAR_ERRORS","CHANGE_RESULT","GEO_CHANGE","GEO_COORDS_CHANGE","SET_CURRENCY","SET_UPDATE_INFO","SET_LAST_ERROR","SET_GEO_LIST","SET_AUTH_USER","START_FETCH","STOP_FETCH","entitiesReducer","state","action","type","response","data","entities","resultReducer","new_state","Object","assign","ids","console","trace","key","result","merger","i","category_id","indexOf","push","fetchedReducer","lastIdsReducer","last_id","allReducer","all_count","authReducer","id","users","USERS_KEY","includes","error_status","modalsReducer","INFO_MODAL_KEY","IMAGE_MODAL_KEY","ATTACH_MODAL_KEY","modal_key","active","params","modal_type","options","errorsReducer","main","status","text","error","regReducer","REG_INIT_KEY","inititialGeo","lists","city","region","country","geoListTypes","geoReducer","items","currencyReducer","environmentReducer","user","messages","menu","updates","platform","version","lastError","ssrInfo","undefined","available","isClient","fetched","lastIds","all","authUser","modals","errors","reg","geo","currency","environment","database","helper","history"],"mappings":"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","sourcesContent":["import merge from 'lodash/merge';\nimport mergeWith from 'lodash/mergeWith';\nimport databaseReducer from './database'\nimport helperReducer from './helper'\nimport historyReducer from './history'\n\nimport {\n\tREQUEST_DATA,\n\tDATA_REMOVE,\n\tRESPONSE_DATA_ADD,\n\tRESPONSE_DATA_REPLACE,\n\tRESPONSE_DATA_NONE,\n\tRESPONSE_AUTH_USER,\n\tRESPONSE_FAIL,\n\tRESET_ON_PAGE,\n\tMODAL_OPEN_INFO,\n\tMODAL_OPEN_WITH_PARAMS,\n\tMODAL_OPEN,\n\tMODAL_CLOSE,\n\tCLEAR_ERRORS,\n\tCHANGE_RESULT,\n\tGEO_CHANGE,\n\tGEO_COORDS_CHANGE,\n\tSET_CURRENCY,\n\tSET_UPDATE_INFO,\n\tSET_LAST_ERROR,\n\tSET_GEO_LIST,\n\tSET_AUTH_USER,\n\tSTART_FETCH,\n\tSTOP_FETCH,\n} from '../actions/actionsTypes';\nconst entitiesReducer = ( state = [], action ) => {\n\tswitch( action.type ) {\n\t\tcase RESPONSE_DATA_REPLACE:\n\t\tcase RESPONSE_DATA_ADD:\n\t\tcase RESPONSE_DATA_NONE:\n\t\tcase RESPONSE_AUTH_USER:\n\t\t\treturn merge( {}, state, action.response.data.entities );\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n/**\n * Creates array of fetched results - array with ids of entities\n * @param  {Object} [state={}] [description]\n * @param  {[type]} action     [description]\n * @return {[type]}            [description]\n */\nconst resultReducer = (state = {}, action) => {\n  let new_state = Object.assign({}, state);\n  let ids = [];\n  switch (action.type) {\n    case RESET_ON_PAGE:\n\t\t\tconsole.trace(\"DEPRECATED\");\n      return Object.assign({}, state, {\n        [action.key]: []\n      });\n    case RESPONSE_DATA_ADD:\n\t\t\tconsole.trace(\"DEPRECATED\");\n      return mergeWith(state, action.response.data.result, merger);\n    case DATA_REMOVE:\n\t\t\tconsole.trace(\"DEPRECATED\");\n      for (let i in new_state[action.key][action.category_id]) {\n        if (action.ids.indexOf(new_state[action.key][action.category_id][i]) === -1) {\n          ids.push(new_state[action.key][action.category_id][i])\n        }\n      }\n      new_state[action.key][action.category_id] = ids;\n      return new_state;\n    case RESPONSE_DATA_REPLACE:\n      return Object.assign({}, state, action.response.data.result);\n    case CHANGE_RESULT:\n      return Object.assign({}, state, {\n        [action.key]: action.ids\n      });\n    case RESPONSE_DATA_NONE:\n    default:\n      return state;\n  }\n}\n\nconst fetchedReducer = ( state = {}, action ) =>\n{\n    switch( action.type )\n    {\n        case REQUEST_DATA:\n\t\t\t\tcase START_FETCH:\n            return merge( {}, state, { [ action.key ]: true } );\n\t\t\t\tcase STOP_FETCH:\n        case RESPONSE_DATA_ADD:\n        case RESPONSE_DATA_REPLACE:\n        case RESPONSE_DATA_NONE:\n        case RESPONSE_FAIL:\n            return merge( {}, state, { [ action.key ]: false } );\n        default:\n            return state;\n    }\n}\n\n\nconst lastIdsReducer = ( state = {}, action ) =>\n{\n    switch( action.type )\n    {\n        case RESPONSE_DATA_ADD:\n        case RESPONSE_DATA_REPLACE:\n        case RESPONSE_DATA_NONE:\n            return Object.assign( {}, state, { [ action.key ]: action.response.last_id } );\n        default:\n            return state;\n    }\n}\n\nconst allReducer = ( state = {}, action ) =>\n{\n    switch( action.type )\n    {\n        case RESPONSE_DATA_REPLACE:\n            return Object.assign( {}, state, { [ action.key ]: action.response.all_count || null } );\n        case RESET_ON_PAGE:\n            return Object.assign( {}, state, { [ action.key ]: null } );\n        default:\n            return state;\n    }\n}\n// const onPageReducer = (state = {}, action) => {\n//   let data, per_page;\n//   switch (action.type) {\n//     case RESET_ON_PAGE:\n//       return merge({}, state, {\n//         [action.key]: action.per_page || 20\n//       });\n//     case RESPONSE_DATA_REPLACE:\n//       data = action.response.data.result[action.key];\n//       return merge({}, state, {\n//         [action.key]: data.length\n//       });\n//     case RESPONSE_DATA_ADD:\n//       data = action.response.data.result[action.key];\n//       per_page = state[action.key] + data.length;\n//       return merge({}, state, {\n//         [action.key]: per_page\n//       });\n//     case RESPONSE_DATA_NONE:\n//     default:\n//       return state;\n//   }\n// }\nconst authReducer = ( state = null, action ) => {\n\tswitch( action.type ) {\n\t\tcase SET_AUTH_USER:\n\t\t\treturn action.id;\n\t\tcase RESPONSE_AUTH_USER:\n\t\t\treturn action.response.data.result.users[ 0 ];\n\t\tcase RESPONSE_FAIL:\n\t\t\tif (action.key === USERS_KEY && [102, 103].includes(action.error_status))\n\t\t\t\treturn 0;\n\t\t\treturn state;\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\nconst modalsReducer = (state = {\n  [INFO_MODAL_KEY]: {},\n  [IMAGE_MODAL_KEY]: {},\n  [ATTACH_MODAL_KEY]: {}\n}, action) => {\n  switch (action.type) {\n    case MODAL_OPEN_WITH_PARAMS:\n      return merge({}, state, {\n        [action.modal_key]: Object.assign({\n          active: true\n        }, action.params)\n      });\n    case MODAL_OPEN_INFO:\n      return merge({}, state, {\n        [action.modal_key]: {\n          type: action.modal_type,\n          active: true,\n          options: action.options\n        }\n      });\n    case MODAL_OPEN:\n      return merge({}, state, {\n        [action.modal_key]: true\n      });\n    case MODAL_CLOSE:\n      return merge({}, state, {\n        [action.modal_key]: false\n      });\n    default:\n      return state;\n  }\n}\n\nconst errorsReducer = ( state = {}, action ) =>\n{\n    switch( action.type )\n    {\n        case RESPONSE_FAIL:\n            if ( action.main )\n            {\n                return {\n                    status: action.error_status,\n                    text: action.error,\n                };\n            }\n            else\n            {\n                return state;\n            }\n        case RESPONSE_DATA_ADD:\n        case RESPONSE_DATA_REPLACE:\n        case RESPONSE_DATA_NONE:\n        case RESPONSE_AUTH_USER:\n        case CLEAR_ERRORS:\n            return {};\n        default:\n            return state;\n    }\n}\n\nconst regReducer = ( state = { status: REG_INIT_KEY } ) => {\n\treturn state;\n}\nconst inititialGeo = {\n\tlists: {\n\t\tcity: [],\n\t\tregion: [],\n\t\tcountry: []\n\t}\n}\nconst geoListTypes = {\n\t'-1': 'country',\n\t1: 'country',\n\t2: 'region',\n\t3: 'city',\n}\nconst geoReducer = (state = inititialGeo, action) => {\n  let new_state = Object.assign({}, state);\n  switch (action.type) {\n    case SET_GEO_LIST:\n      for (let i in geoListTypes) {\n        new_state.lists[geoListTypes[i]] = [];\n      }\n      for (let i in action.items) {\n        new_state.lists[geoListTypes[action.items[i].type]].push(action.items[i]);\n      }\n      return new_state;\n    case GEO_CHANGE:\n    case GEO_COORDS_CHANGE:\n      return Object.assign({}, state, action.data);\n    default:\n      return state;\n  }\n}\nconst currencyReducer = ( state = {}, action ) => {\n\tswitch (action.type) {\n\t\tcase SET_CURRENCY:\n\t\t\treturn {id: action.id}\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\nconst environmentReducer = ( state = {\n\tuser: {},\n\tmessages: {},\n\tmenu: {},\n}, action ) => {\n\tlet new_state = Object.assign({}, state);\n\tswitch (action.type) {\n\t\tcase SET_UPDATE_INFO:\n\t\t\tnew_state.updates = Object.assign({}, new_state.updates, {\n\t\t\t\t[action.platform]: action.version\n\t\t\t})\n\t\t\treturn new_state;\n\t\tcase SET_LAST_ERROR:\n\t\t\tnew_state.lastError = action.text\n\t\t\treturn new_state;\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n\nexport default ( state = {}, action ) => {\n\treturn {\n\t\tssrInfo:\t\t\t\tstate.ssrInfo === undefined ? {available: false} : state.ssrInfo,\n\t\tisClient:\t\t\t\tstate.isClient === undefined ? true : state.isClient,\n\t\tentities:\t\t\t\tentitiesReducer( state.entities, action ),\n\t\tresult:\t\t\t\t\tresultReducer( state.result, action ),\n\t\tfetched:\t\t\t\tfetchedReducer( state.fetched, action ),\n\t\tlastIds:\t\t\t\tlastIdsReducer( state.lastIds, action ),\n\t\tall:\t\t\t\t\t\tallReducer( state.all, action ),\n\t\tauthUser:\t\t\t\tauthReducer( state.authUser, action ),\n\t\tmodals:\t\t\t\t\tmodalsReducer( state.modals, action ),\n\t\terrors:\t\t\t\t\terrorsReducer( state.errors, action ),\n\t\treg:\t\t\t\t\t\tregReducer( state.reg, action ),\n\t\tgeo:\t\t\t\t\t\tgeoReducer( state.geo, action ),\n\t\tcurrency:\t\t\t\tcurrencyReducer(state.currency, action),\n\t\tenvironment:\t\tenvironmentReducer(state.environment, action),\n\t\tdatabase:\t\t\t\tdatabaseReducer(state.database, action),\n\t\thelper:\t\t\t\t\thelperReducer(state.helper, action),\n\t\thistory:\t\t\t\thistoryReducer(state.history, action)\n\t};\n}\n"]},"metadata":{},"sourceType":"module"}